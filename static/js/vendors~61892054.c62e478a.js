(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{109:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i={};n.r(i),n.d(i,"Express",(function(){return c})),n.d(i,"Postgres",(function(){return p.a})),n.d(i,"Mysql",(function(){return l.a})),n.d(i,"Mongo",(function(){return f.a}));var a=n(0),r=n(152),o=n(47),s=n(5),c=function(){function t(e){void 0===e&&(e={}),this.name=t.id,this._router=e.router||e.app,this._methods=(Array.isArray(e.methods)?e.methods:[]).concat("use")}return t.prototype.setupOnce=function(){this._router?function(t,e){void 0===e&&(e=[]);e.forEach((function(e){return function(t,e){var n=t[e];return t[e]=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return n.call.apply(n,Object(a.g)([this],d(t,e)))},t}(t,e)}))}(this._router,this._methods):s.a.error("ExpressIntegration is missing an Express instance")},t.id="Express",t}();function u(t,e){var n=t.length;switch(n){case 2:return function(n,i){var a=i.__sentry_transaction;if(a){var r=a.startChild({description:t.name,op:"middleware."+e});i.once("finish",(function(){r.finish()}))}return t.call(this,n,i)};case 3:return function(n,i,r){var o,s=null===(o=i.__sentry_transaction)||void 0===o?void 0:o.startChild({description:t.name,op:"middleware."+e});t.call(this,n,i,(function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];null===(t=s)||void 0===t||t.finish(),r.call.apply(r,Object(a.g)([this],e))}))};case 4:return function(n,i,r,o){var s,c=null===(s=r.__sentry_transaction)||void 0===s?void 0:s.startChild({description:t.name,op:"middleware."+e});t.call(this,n,i,r,(function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];null===(t=c)||void 0===t||t.finish(),o.call.apply(o,Object(a.g)([this],e))}))};default:throw new Error("Express middleware takes 2-4 arguments. Got: "+n)}}function d(t,e){return t.map((function(t){return"function"==typeof t?u(t,e):Array.isArray(t)?t.map((function(t){return"function"==typeof t?u(t,e):t})):t}))}var p=n(97),l=n(98),f=n(99),h=Object(a.a)(Object(a.a)({},i),{BrowserTracing:r.a});Object(o.a)()},47:function(t,e,n){"use strict";n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return v}));var i=n(0),a=n(13),r=n(77),o=n(5),s=n(108),c=n(55),u=n(56),d=n(10);function p(){var t=this.getScope();if(t){var e=t.getSpan();if(e)return{"sentry-trace":e.toTraceparent()}}return{}}function l(t,e,n){return Object(d.c)(e)?void 0!==t.sampled?(t.setMetadata({transactionSampling:{method:r.a.Explicit}}),t):("function"==typeof e.tracesSampler?(i=e.tracesSampler(n),t.setMetadata({transactionSampling:{method:r.a.Sampler,rate:Number(i)}})):void 0!==n.parentSampled?(i=n.parentSampled,t.setMetadata({transactionSampling:{method:r.a.Inheritance}})):(i=e.tracesSampleRate,t.setMetadata({transactionSampling:{method:r.a.Rate,rate:Number(i)}})),function(t){if(isNaN(t)||"number"!=typeof t&&"boolean"!=typeof t)return o.a.warn("[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got "+JSON.stringify(t)+" of type "+JSON.stringify(typeof t)+"."),!1;if(t<0||t>1)return o.a.warn("[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got "+t+"."),!1;return!0}(i)?i?(t.sampled=Math.random()<i,t.sampled?(o.a.log("[Tracing] starting "+t.op+" transaction - "+t.name),t):(o.a.log("[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = "+Number(i)+")"),t)):(o.a.log("[Tracing] Discarding transaction because "+("function"==typeof e.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0")),t.sampled=!1,t):(o.a.warn("[Tracing] Discarding transaction because of invalid sample rate."),t.sampled=!1,t)):(t.sampled=!1,t);var i}function f(t,e){var n,a,r=(null===(n=this.getClient())||void 0===n?void 0:n.getOptions())||{},o=new u.a(t,this);return(o=l(o,r,Object(i.a)({parentSampled:t.parentSampled,transactionContext:t},e))).sampled&&o.initSpanRecorder(null===(a=r._experiments)||void 0===a?void 0:a.maxSpans),o}function h(t,e,n,a,r){var o,s,u=(null===(o=t.getClient())||void 0===o?void 0:o.getOptions())||{},d=new c.b(e,t,n,a);return(d=l(d,u,Object(i.a)({parentSampled:e.parentSampled,transactionContext:e},r))).sampled&&d.initSpanRecorder(null===(s=u._experiments)||void 0===s?void 0:s.maxSpans),d}function v(){var t;(t=Object(a.c)()).__SENTRY__&&(t.__SENTRY__.extensions=t.__SENTRY__.extensions||{},t.__SENTRY__.extensions.startTransaction||(t.__SENTRY__.extensions.startTransaction=f),t.__SENTRY__.extensions.traceHeaders||(t.__SENTRY__.extensions.traceHeaders=p)),Object(s.a)()}},55:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return p}));var i=n(0),a=n(61),r=n(5),o=n(48),s=n(20),c=n(56),u=1e3,d=function(t){function e(e,n,i,a){void 0===i&&(i="");var r=t.call(this,a)||this;return r._pushActivity=e,r._popActivity=n,r.transactionSpanId=i,r}return Object(i.c)(e,t),e.prototype.add=function(e){var n=this;e.spanId!==this.transactionSpanId&&(e.finish=function(t){e.endTimestamp="number"==typeof t?t:Object(a.c)(),n._popActivity(e.spanId)},void 0===e.endTimestamp&&this._pushActivity(e.spanId)),t.prototype.add.call(this,e)},e}(o.b),p=function(t){function e(e,n,i,a){void 0===i&&(i=u),void 0===a&&(a=!1);var o=t.call(this,e,n)||this;return o._idleHub=n,o._idleTimeout=i,o._onScope=a,o.activities={},o._heartbeatTimer=0,o._heartbeatCounter=0,o._finished=!1,o._beforeFinishCallbacks=[],n&&a&&(l(n),r.a.log("Setting idle transaction on scope. Span ID: "+o.spanId),n.configureScope((function(t){return t.setSpan(o)}))),o._initTimeout=setTimeout((function(){o._finished||o.finish()}),o._idleTimeout),o}return Object(i.c)(e,t),e.prototype.finish=function(e){var n,o,c=this;if(void 0===e&&(e=Object(a.c)()),this._finished=!0,this.activities={},this.spanRecorder){r.a.log("[Tracing] finishing IdleTransaction",new Date(1e3*e).toISOString(),this.op);try{for(var u=Object(i.i)(this._beforeFinishCallbacks),d=u.next();!d.done;d=u.next()){(0,d.value)(this,e)}}catch(t){n={error:t}}finally{try{d&&!d.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}this.spanRecorder.spans=this.spanRecorder.spans.filter((function(t){if(t.spanId===c.spanId)return!0;t.endTimestamp||(t.endTimestamp=e,t.setStatus(s.a.Cancelled),r.a.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(t,void 0,2)));var n=t.startTimestamp<e;return n||r.a.log("[Tracing] discarding Span since it happened after Transaction was finished",JSON.stringify(t,void 0,2)),n})),r.a.log("[Tracing] flushing IdleTransaction")}else r.a.log("[Tracing] No active IdleTransaction");return this._onScope&&l(this._idleHub),t.prototype.finish.call(this,e)},e.prototype.registerBeforeFinishCallback=function(t){this._beforeFinishCallbacks.push(t)},e.prototype.initSpanRecorder=function(t){var e=this;if(!this.spanRecorder){this.spanRecorder=new d((function(t){e._finished||e._pushActivity(t)}),(function(t){e._finished||e._popActivity(t)}),this.spanId,t),r.a.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)},e.prototype._pushActivity=function(t){this._initTimeout&&(clearTimeout(this._initTimeout),this._initTimeout=void 0),r.a.log("[Tracing] pushActivity: "+t),this.activities[t]=!0,r.a.log("[Tracing] new activities count",Object.keys(this.activities).length)},e.prototype._popActivity=function(t){var e=this;if(this.activities[t]&&(r.a.log("[Tracing] popActivity "+t),delete this.activities[t],r.a.log("[Tracing] new activities count",Object.keys(this.activities).length)),0===Object.keys(this.activities).length){var n=this._idleTimeout,i=Object(a.c)()+n/1e3;setTimeout((function(){e._finished||e.finish(i)}),n)}},e.prototype._beat=function(){if(clearTimeout(this._heartbeatTimer),!this._finished){var t=Object.keys(this.activities),e=t.length?t.reduce((function(t,e){return t+e})):"";e===this._prevHeartbeatString?this._heartbeatCounter+=1:this._heartbeatCounter=1,this._prevHeartbeatString=e,this._heartbeatCounter>=3?(r.a.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus(s.a.DeadlineExceeded),this.setTag("heartbeat","failed"),this.finish()):this._pingHeartbeat()}},e.prototype._pingHeartbeat=function(){var t=this;r.a.log("pinging Heartbeat -> current counter: "+this._heartbeatCounter),this._heartbeatTimer=setTimeout((function(){t._beat()}),5e3)},e}(c.a);function l(t){if(t){var e=t.getScope();if(e)e.getTransaction()&&e.setSpan(void 0)}}},97:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return o}));var i=n(45),a=n(5),r=n(12),o=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(e,n){var o;try{o=Object(i.a)(t,"pg").Client}catch(t){return void a.a.error("Postgres Integration was unable to require `pg` package.")}Object(r.c)(o.prototype,"query",(function(t){return function(e,i,a){var r,o,s=null===(o=null===(r=n().getScope())||void 0===r?void 0:r.getSpan())||void 0===o?void 0:o.startChild({description:"string"==typeof e?e:e.text,op:"db"});return"function"==typeof a?t.call(this,e,i,(function(t,e){var n;null===(n=s)||void 0===n||n.finish(),a(t,e)})):"function"==typeof i?t.call(this,e,(function(t,e){var n;null===(n=s)||void 0===n||n.finish(),i(t,e)})):t.call(this,e,i).then((function(t){var e;return null===(e=s)||void 0===e||e.finish(),t}))}}))},e.id="Postgres",e}()}).call(this,n(63)(t))},98:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return o}));var i=n(45),a=n(5),r=n(12),o=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(e,n){var o;try{o=Object(i.a)(t,"mysql/lib/Connection.js")}catch(t){return void a.a.error("Mysql Integration was unable to require `mysql` package.")}Object(r.c)(o,"createQuery",(function(t){return function(e,i,a){var r,o,s=null===(o=null===(r=n().getScope())||void 0===r?void 0:r.getSpan())||void 0===o?void 0:o.startChild({description:"string"==typeof e?e:e.sql,op:"db"});return"function"==typeof a?t.call(this,e,i,(function(t,e,n){var i;null===(i=s)||void 0===i||i.finish(),a(t,e,n)})):"function"==typeof i?t.call(this,e,(function(t,e,n){var a;null===(a=s)||void 0===a||a.finish(),i(t,e,n)})):t.call(this,e,i,a)}}))},e.id="Mysql",e}()}).call(this,n(63)(t))},99:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return d}));var i=n(0),a=n(45),r=n(5),o=n(12),s=n(6),c=["aggregate","bulkWrite","countDocuments","createIndex","createIndexes","deleteMany","deleteOne","distinct","drop","dropIndex","dropIndexes","estimatedDocumentCount","find","findOne","findOneAndDelete","findOneAndReplace","findOneAndUpdate","indexes","indexExists","indexInformation","initializeOrderedBulkOp","insertMany","insertOne","isCapped","mapReduce","options","parallelCollectionScan","rename","replaceOne","stats","updateMany","updateOne"],u={bulkWrite:["operations"],countDocuments:["query"],createIndex:["fieldOrSpec"],createIndexes:["indexSpecs"],deleteMany:["filter"],deleteOne:["filter"],distinct:["key","query"],dropIndex:["indexName"],find:["query"],findOne:["query"],findOneAndDelete:["filter"],findOneAndReplace:["filter","replacement"],findOneAndUpdate:["filter","update"],indexExists:["indexes"],insertMany:["docs"],insertOne:["doc"],mapReduce:["map","reduce"],rename:["newName"],replaceOne:["filter","doc"],updateMany:["filter","update"],updateOne:["filter","update"]},d=function(){function e(t){void 0===t&&(t={}),this.name=e.id,this._operations=Array.isArray(t.operations)?t.operations:c,this._describeOperations=!("describeOperations"in t)||t.describeOperations,this._useMongoose=!!t.useMongoose}return e.prototype.setupOnce=function(e,n){var i,o=this._useMongoose?"mongoose":"mongodb";try{i=Object(a.a)(t,o).Collection}catch(t){return void r.a.error("Mongo Integration was unable to require `"+o+"` package.")}this._instrumentOperations(i,this._operations,n)},e.prototype._instrumentOperations=function(t,e,n){var i=this;e.forEach((function(e){return i._patchOperation(t,e,n)}))},e.prototype._patchOperation=function(t,e,n){if(e in t.prototype){var a=this._getSpanContextFromOperationArguments.bind(this);Object(o.c)(t.prototype,e,(function(t){return function(){for(var r,o,c,u,d=[],p=0;p<arguments.length;p++)d[p]=arguments[p];var l=d[d.length-1],f=n().getScope(),h=null===(r=f)||void 0===r?void 0:r.getSpan();if("function"!=typeof l||"mapReduce"===e&&2===d.length){var v=null===(o=h)||void 0===o?void 0:o.startChild(a(this,e,d)),m=t.call.apply(t,Object(i.g)([this],d));return Object(s.m)(m)?m.then((function(t){var e;return null===(e=v)||void 0===e||e.finish(),t})):(null===(c=v)||void 0===c||c.finish(),m)}var g=null===(u=h)||void 0===u?void 0:u.startChild(a(this,e,d.slice(0,-1)));return t.call.apply(t,Object(i.g)([this],d.slice(0,-1),[function(t,e){var n;null===(n=g)||void 0===n||n.finish(),l(t,e)}]))}}))}},e.prototype._getSpanContextFromOperationArguments=function(t,e,n){var a={collectionName:t.collectionName,dbName:t.dbName,namespace:t.namespace},r={op:"db",description:e,data:a},o=u[e],s=Array.isArray(this._describeOperations)?this._describeOperations.includes(e):this._describeOperations;if(!o||!s)return r;try{if("mapReduce"===e){var c=Object(i.e)(n,2),d=c[0],p=c[1];a[o[0]]="string"==typeof d?d:d.name||"<anonymous>",a[o[1]]="string"==typeof p?p:p.name||"<anonymous>"}else for(var l=0;l<o.length;l++)a[o[l]]=JSON.stringify(n[l])}catch(t){}return r},e.id="Mongo",e}()}).call(this,n(63)(t))}}]);